
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>whazzing around</title>
  <meta name="author" content="Zachery Moneypenny">

  
  <meta name="description" content="Since this summer I&rsquo;ve been quite busy both at work and on local projects and
figured it was time to reflect and look towards the upcoming year &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://whazzing.com">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="whazzing around" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-8888483-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">whazzing around</a></h1>
  
    <h2>a thing on the internet</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:whazzing.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/presentations">Presentations</a></li>
  <li><a href="/videos">Videos</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/12/01/catching-up/">Catching Up</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-01T08:45:00-06:00" pubdate data-updated="true">Dec 1<span>st</span>, 2013</time>
        
           | <a href="/blog/2013/12/01/catching-up/#disqus_thread"
             data-disqus-identifier="http://whazzing.com/blog/2013/12/01/catching-up/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Since this summer I&rsquo;ve been quite busy both at work and on local projects and
figured it was time to reflect and look towards the upcoming year.</p>

<h2>2013: The Year in Review</h2>

<p>Let&rsquo;s talk about work stuff and home stuff.</p>

<h3>@Work</h3>

<p>At work, I started 2013 as primarily a <strong>C/C++ developer</strong> working on connecting
our flagship accounting application to connected services.
It was extremely interesting, if sometimes frustrating, to enhance a 15-year-old
code base to talk to a new generation of more nimble web services. Throughout
the summer we stamped out bugs and responded to early feedback from testers, as
well as worked on merges out to all the major versions of the code base. At the
same time we started prepping documentation and transition materials to ease the
difficulty in transferring knowledge of a 20+ year-old
code base to a new team.</p>

<p>Starting in August I began splitting my time between my desktop development
tasks and my new group. I&rsquo;m now working on
<a href="http://paychecks.intuit.com">ViewMyPaycheck</a>, which is built on
<a href="http://backbonejs.org">Backbone.js</a>/HTML5/<a href="http://sass-lang.com">SCSS</a> for
the front-end and Java Web Services on the backend. It&rsquo;s really my first time
developing in Java, and so I&rsquo;m learning new things every day.</p>

<p>Luckily, due to my extensive tours of different Javascript frameworks in my
Rails projects at home I was able to come strong out of the gate in working
on the Backbone code. My experience with Sass allowed me to not only pick
up our styles quickly, but re-architect them to ease the evolution and
concurrent development by multiple engineers.</p>

<p>There was some tech debt wrapped up in the new code base but my excellent team
has thus far done a great job of prioritizing refactoring and
build/infrastructure improvements against the race to be feature-complete for
the 2013 tax season.</p>

<h3>@Home</h3>

<p>The holiday season of 2012 was quite a disaster in my family&rsquo;s annual gift
exchange. Each adult had to submit a list of things they wanted to my mom, and
then she drew the names for <strong>two</strong> different exchanges: one for our immediate
family and one for our extended family. When Xmas Morning arrived we found a
ridiculous outcome: <em>since most everyone had gone for the &lsquo;easy&rsquo; thing on their
target&rsquo;s gift list, most people received two of one thing on their list</em>.</p>

<p>It spoke to an age-old problem of holiday gift-giving where, when grandparents,
aunts, uncles, etc. all clamor for a list of things a kid wants, they have no
way of ensuring that someone else didn&rsquo;t already buy something on the list.
So in the ensuing winter, when I just so happened to have a lot of time on my
hands due to the birth of my son, I set out to create a web app to solve the
problem.</p>

<p>I finished a pre-alpha version of <a href="http://giftr.us">giftr.us</a> in the spring and
my family used it for birthdays throughout the spring and summer. It&rsquo;s in a
pretty good spot right now, but I wasn&rsquo;t able to finish the formal <strong>Gift
Exchange</strong> functionality for the 2013 Holidays.</p>

<p>This year I also began a journey to help out the
<a href="http://madrailers.org">MadRailers Meetup</a> which culminated in me taking over
the organization in the fall. I&rsquo;ve been a member of the meetup since roundabouts
shortly after I moved back from California, and it&rsquo;s enabled me to meet a ton
of great folks in the Madison tech community. I started out volunteering for
talks in the spring, and in the summer I started suggesting other topics or
speakers.  By the time of the
<a href="http://madisonruby.com">Madison Ruby conference</a> we&rsquo;d laid out a great schedule
of speakers throughout the end of the year, and I&rsquo;m really pleased with where
the group is headed and our new space: the newly-renovated
<a href="http://mynewlibrary.org/">Madison Public Library</a>!</p>

<h2>2014: The Year to Come</h2>

<h3>@Work</h3>

<p>I&rsquo;m incredibly excited to continue the modernization our Backbone app. A short
list of the changes and/or improvements I&rsquo;m planning:</p>

<ul>
<li>Move to using DevOps-provided <a href="http://www.vagrantup.com/">Vagrant</a> images on
developer machines to more closely align development and deployment
environments.</li>
<li>Move our static site code (HTML/CSS/JS/Images) to a CDN to improve load times.</li>
<li>Move from <a href="http://ant.apache.org/">Ant</a> to <a href="http://gruntjs.com">Grunt</a> to
build the site (transpile SCSS, run JS tests, etc.)</li>
<li>Move from base Backbone.js to <a href="http://marionettejs.com/">Marionette.js</a> to
get better support for composing layouts, regions, and views.</li>
<li>Router changes to better control the fetching of data.</li>
</ul>


<p>These are all technical in nature; we&rsquo;re obviously going to parallelize these
more architectural and platform-ish changes alongside the improvements to the
user workflow and enhancements based on user feedback. My ultimate goal is to
get the app into a continuously deployable build process. We&rsquo;re a ways off right
now but it&rsquo;s definitely doable.</p>

<h3>@Home</h3>

<p>I&rsquo;m going to continue to develop Giftr&rsquo;s gift exchange functionality, and I may
explore either turning it into a single-page app via Ember.js or similar, or
I may dip my toe into mobile native development. I&rsquo;m incredibly interested
in learning more about <a href="http://xamarin.com/">Xamarin</a> for doing cross-platform
mobile development.</p>

<p>I&rsquo;m also going to continue to develop more programming for MadRailers. In 2014
we&rsquo;d love to explore joint-sponsored meetups with other local tech groups,
as well as move towards more diversity in our speaker lineups and membership.
We&rsquo;ll be sponsoring more Newbie Nights as well as itermittent Hack Days.</p>

<h2>And Sooooo&hellip;</h2>

<p>It&rsquo;s been a pretty good year! I was somehow able to maintain <em>some</em> level of
progress on my own development projects even with the birth of the first kid,
and I&rsquo;m getting out of my comfort zone in my professional development which
is refreshing. Here&rsquo;s to continuing to learn and improve in 2014!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/04/11/automated-clickonce-build-and-deploy-using-powershell-and-msbuild/">Automated ClickOnce Build and Deploy Using Powershell and MSBuild</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-11T12:14:00-05:00" pubdate data-updated="true">Apr 11<span>th</span>, 2013</time>
        
           | <a href="/blog/2013/04/11/automated-clickonce-build-and-deploy-using-powershell-and-msbuild/#disqus_thread"
             data-disqus-identifier="http://whazzing.com/blog/2013/04/11/automated-clickonce-build-and-deploy-using-powershell-and-msbuild/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>As I was nearing completion on the <a href="">WPF app I described in an earlier post</a> I became focused on how to easily build and deploy it to our developer and QA team. I had decided to use <a href="http://en.wikipedia.org/wiki/ClickOnce">ClickOnce</a> to facilitate easy updates, but I wanted to make it dead-simple to build and deploy the installer/updater to the network share so that anyone could easily contribute to the tool development.</p>

<p>At the time I&rsquo;d been doing quite a bit of Powershell work and coincidentally I stumbled on the <a href="https://github.com/blog/1271-how-we-ship-github-for-windows">Github post</a> on how they build the <a href="http://windows.github.com/">Github for Windows application</a>. In that post I saw a tantalizing screen capture of their build/deploy script output and knew at once that I must have it.</p>

<p style="text-align:center;"><img src="/images/github-for-windows.png" height="183" width="673"/></p>


<p>From that image I reverse engineered the steps my script needed to take, and then I had to figure out how to implement each step. It&rsquo;s worth noting that <strong>ClickOnce setting manipulation and deployment is not available via scripting or MSBuild commands</strong>. The code below includes my solution to these issues.</p>

<h2>Build &amp; Deployment Script Output</h2>

<p>Below is the output of my own build and deployment script. A couple of important notes:</p>

<ul>
<li>My application consisted of one .exe file and one .dll file corresponding to two projects in a single Visual Studio solution. In the example code below I&rsquo;ve replaced my .exe project name with <strong>Executable</strong> and my .dll project name with <strong>Library</strong>. The ClickOnce settings are maintained in the Executable project file.</li>
<li><strong>I should note that a decision I made is that the installer version should always be the same as the executable version.</strong> For a small tool like this it makes things simpler than to version the installer independently of the application it installs.</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PS C:\dev\tools\Executable> .\Deploy.ps1
</span><span class='line'> Checking prerequisites...
</span><span class='line'> Checking out the AssemblyInfo.cs files for version increment...
</span><span class='line'> Cleaning the build directory...
</span><span class='line'> Building Executable application...
</span><span class='line'> Building ClickOnce installer...
</span><span class='line'> Deploying updates to network server...
</span><span class='line'> Comitting version increments to Perforce...
</span><span class='line'>PS C:\dev\tools\Executable></span></code></pre></td></tr></table></div></figure>


<p>The script is written to be very silent unless an error occurs, so below is a description in more detail. The script does the following:</p>

<ul>
<li>Checks to ensure that the current user has prerequisites installed (in this case perforce).</li>
<li>Checks out the appropriate files needed to increment the version number of the DLL, executable, and ClickOnce installer.</li>
<li>Cleans the build directory.</li>
<li>Builds the DLL and executable.</li>
<li>Retrieves the (file) version of the newly-build executable.</li>
<li>Forces (hacks) the executable version into the executable&rsquo;s .csproj definition of the ClickOnce settings.</li>
<li>Builds the installer with the new version and the just-built binaries.</li>
<li>Copies all of the installer files to the appropriate network fileserver.</li>
<li>Commit the changes to the AssemblyInfo and csproj files (i.e., the version changes).</li>
</ul>


<h2>Build &amp; Deployment Script</h2>

<p><strong>Please note</strong> that I&rsquo;ve changed a few things about the script below:</p>

<ul>
<li>Perforce repository paths</li>
<li>Network deployment paths</li>
<li>Binary names</li>
</ul>


<p>I&rsquo;ve included the entire (sanitized) script below, and after it describe in greater detail the interesting parts.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Write-Host "Tool Build/Deployment Script"
</span><span class='line'>
</span><span class='line'>$outputPrefix = " "
</span><span class='line'>$msbuild = "C:\Windows\Microsoft.NET\Framework\v4.0.30319\msbuild.EXE"
</span><span class='line'>
</span><span class='line'>Write-Host $outputPrefix"Checking prerequisites..."
</span><span class='line'>
</span><span class='line'>$p4Output = p4
</span><span class='line'>if($p4Output -match "'p4' is not recognized as an internal or external command")
</span><span class='line'>{
</span><span class='line'>  Write-Error "Cannot find p4.exe in your PATH."
</span><span class='line'>  Exit
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>Write-Host $outputPrefix"Checking out the AssemblyInfo.cs files for version increment..."
</span><span class='line'>p4 edit //my/project/tool/path/Library/Properties/AssemblyInfo.cs | Out-Null
</span><span class='line'>p4 edit //my/project/tool/path/Executable/Properties/AssemblyInfo.cs | Out-Null
</span><span class='line'>p4 edit //my/project/tool/path/Executable/Executable.csproj | Out-Null
</span><span class='line'>
</span><span class='line'>Write-Host $outputPrefix"Cleaning the build directory..."
</span><span class='line'>Invoke-Expression "$msbuild Executable\Executable.csproj /p:Configuration=Release /p:Platform=AnyCPU /t:clean /v:quiet /nologo"
</span><span class='line'>
</span><span class='line'>Write-Host $outputPrefix"Building Executable application..."
</span><span class='line'>Invoke-Expression "$msbuild Executable\Executable.csproj /p:Configuration=Release /p:Platform=AnyCPU /t:build /v:quiet /nologo"
</span><span class='line'>
</span><span class='line'>$newExeVersion = Get-ChildItem .\Executable\bin\Release\Executable.exe | Select-Object -ExpandProperty VersionInfo | % { $_.FileVersion }
</span><span class='line'>$newLibVersion = Get-ChildItem .\Executable\bin\Release\Library.dll | Select-Object -ExpandProperty VersionInfo | % { $_.FileVersion }
</span><span class='line'>
</span><span class='line'>Write-Host $outputPrefix"Building ClickOnce installer..."
</span><span class='line'>#
</span><span class='line'># Because the ClickOnce target doesn't automatically update or sync the application version
</span><span class='line'># with the assembly version of the EXE, we need to grab the version off of the built assembly
</span><span class='line'># and update the Executable.csproj file with the new application version.
</span><span class='line'>#
</span><span class='line'>$ProjectXml = [xml](Get-Content Executable\Executable.csproj)
</span><span class='line'>$ns = new-object Xml.XmlNamespaceManager $ProjectXml.NameTable
</span><span class='line'>$ns.AddNamespace('msb', 'http://schemas.microsoft.com/developer/msbuild/2003')
</span><span class='line'>$AppVersion = $ProjectXml.SelectSingleNode("//msb:Project/msb:PropertyGroup/msb:ApplicationVersion", $ns)
</span><span class='line'>$AppVersion.InnerText = $newExeVersion
</span><span class='line'>$TargetPath = Resolve-Path "Executable\Executable.csproj"
</span><span class='line'>$ProjectXml.Save($TargetPath)
</span><span class='line'>
</span><span class='line'>Invoke-Expression "$msbuild Executable\Executable.csproj /p:Configuration=Release /p:Platform=AnyCPU /t:publish /v:quiet /nologo"
</span><span class='line'>
</span><span class='line'>Write-Host $outputPrefix"Deploying updates to network server..."
</span><span class='line'>$LocalInstallerPath = (Resolve-Path "Executable\bin\Release\app.publish").ToString() + "\*"
</span><span class='line'>$RemoteInstallerPath = "\\network\path\Executable\DesktopClient\"
</span><span class='line'>Copy-Item $LocalInstallerPath $RemoteInstallerPath -Recurse -Force
</span><span class='line'>
</span><span class='line'>Write-Host $outputPrefix"Committing version increments to Perforce..."
</span><span class='line'>p4 submit -d "Updating Executable ClickOnce Installer to version $newExeVersion" //my/project/tool/path/Executable/Executable.csproj | Out-Null
</span><span class='line'>p4 submit -d "Updating Library to version $newLibVersion" //my/project/tool/path/Library/Properties/AssemblyInfo.cs | Out-Null
</span><span class='line'>p4 submit -d "Updating Executable to version $newExeVersion" //my/project/tool/path/Executable/Properties/AssemblyInfo.cs | Out-Null</span></code></pre></td></tr></table></div></figure>


<h3>Automated Version Increment</h3>

<p>You may have noticed that I don&rsquo;t take any specific action to manage the version numbers of Executable.exe and Library.dll even though I explicitly check out the AssemblyInfo.cs files.</p>

<p>The <a href="http://msbuildextensionpack.codeplex.com/">MSBuild Extension Pack</a> is an open-source collection of MSBuild targets that make things like version management much easier. After adding the extensions to a relative path to my projects I just needed to add the following near the bottom of <code>Executable.csproj</code>.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;PropertyGroup&gt;</span>
</span><span class='line'>  <span class="nt">&lt;ExtensionTasksPath&gt;</span>..\contrib\ExtensionPack\4.0.6.0\<span class="nt">&lt;/ExtensionTasksPath&gt;</span>
</span><span class='line'><span class="nt">&lt;/PropertyGroup&gt;</span>
</span><span class='line'><span class="nt">&lt;Import</span> <span class="na">Project=</span><span class="s">&quot;$(ExtensionTasksPath)MSBuild.ExtensionPack.VersionNumber.targets&quot;</span>
</span><span class='line'>  <span class="na">Condition=</span><span class="s">&quot; &#39;$(BuildingInsideVisualStudio)&#39;!=&#39;true&#39; &quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;PropertyGroup</span> <span class="na">Condition=</span><span class="s">&quot; &#39;$(BuildingInsideVisualStudio)&#39;!=&#39;true&#39; &quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;AssemblyMajorVersion&gt;</span>1<span class="nt">&lt;/AssemblyMajorVersion&gt;</span>
</span><span class='line'>  <span class="nt">&lt;AssemblyMinorVersion&gt;</span>3<span class="nt">&lt;/AssemblyMinorVersion&gt;</span>
</span><span class='line'>  <span class="nt">&lt;AssemblyFileMajorVersion&gt;</span>1<span class="nt">&lt;/AssemblyFileMajorVersion&gt;</span>
</span><span class='line'>  <span class="nt">&lt;AssemblyFileMinorVersion&gt;</span>3<span class="nt">&lt;/AssemblyFileMinorVersion&gt;</span>
</span><span class='line'>  <span class="nt">&lt;AssemblyInfoSpec&gt;</span>Properties\AssemblyInfo.cs<span class="nt">&lt;/AssemblyInfoSpec&gt;</span>
</span><span class='line'><span class="nt">&lt;/PropertyGroup&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>A couple things to note here:</p>

<ul>
<li>The <code>Condition</code> attributes on lines 5 &amp; 6 ensure that the version increments only occur when I run the <code>Deploy.ps1</code> script, as opposed to every time I build through the Visual Studio IDE.</li>
<li>I am holding the Major and Minor versions fixed via lines 7-10, so that only the Build and Revision numbers are auto-incremented.</li>
</ul>


<p>The above code is used <strong>both</strong> in <code>Executable.csproj</code> and <code>Library.csproj</code>, so that both the executable and the library have their version numbers managed. In doing this I can also change the major/minor versions of the executable and library independently.</p>

<h3>Propagate Exe Version to ClickOnce Installer</h3>

<p>As I mentioned earlier, I wanted to keep the installer version the same as the executable version. The problem was that there&rsquo;s no way to manage the ClickOnce settings via MSBuild or other API. Lines 35-41 of the script are the, ahem, workaround that I devised.</p>

<p>Since we want to set the ClickOnce installer version to the same as the executable, we must first fetch the executable version:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$newExeVersion = Get-ChildItem .\Executable\bin\Release\Executable.exe | Select-Object -ExpandProperty VersionInfo | % { $_.FileVersion }</span></code></pre></td></tr></table></div></figure>


<p>This line uses the <a href="http://technet.microsoft.com/en-us/library/ee176927.aspx">powerful object piping capabilities in Powershell</a> to fetch the FileVersion property from the assembly itself.</p>

<p>Once we have the executable version, we must then somehow insert it into <code>Executable.csproj</code> where the ClickOnce settings are defined. For reference, the associated XML from the csproj file is:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;PropertyGroup&gt;</span>
</span><span class='line'>  <span class="nt">&lt;ApplicationVersion&gt;</span>1.3.0407.01<span class="nt">&lt;/ApplicationVersion&gt;</span>
</span><span class='line'><span class="nt">&lt;/PropertyGroup&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Lines 35-41 read in the csproj file as XML and extracts the <code>ApplicationVersion</code> node. It then replaces the contents of that node with the assembly version we read from the executable and saves the entire XML structure back to the csproj file.</p>

<h2>Summary</h2>

<p>Through automating the build and deployment process I&rsquo;ve learned a lot about Powershell and MSBuild and I&rsquo;ll definitely be improving this in the future. The great thing about this particular combination of tools is that Powershell provides the glue that holds together the powerful build automation (and logging) that MSBuild offers.</p>

<p>While it&rsquo;s unfortunate that ClickOnce has so many manual aspects to it (and I think I know why) the ease of XML manipulation and file processing from Powershell make it easy to work around ClickOnce&rsquo;s lack of automation.</p>

<p>In the future I may look at moving the install/upgrade process to the <a href="http://www.wixtoolset.org/">WiX Toolset</a> as it&rsquo;s much more configurable and automatable. ClickOnce was really a stop-gap solution because it&rsquo;s for an internal tool and simple enough for my bootstrapping needs.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/22/responsive-wpf-applications-with-reactiveui/">Responsive WPF Applications With ReactiveUI</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-22T21:25:00-06:00" pubdate data-updated="true">Feb 22<span>nd</span>, 2013</time>
        
           | <a href="/blog/2013/02/22/responsive-wpf-applications-with-reactiveui/#disqus_thread"
             data-disqus-identifier="http://whazzing.com/blog/2013/02/22/responsive-wpf-applications-with-reactiveui/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Learn about my newfound love for the <a href="http://reactiveui.net/">ReactiveUI MVVM framework</a>.</p>

<p>My day job is to wrangle 12 million lines of 20+ year-old C and C++ using a custom Win32-based UI library that was built in the mid-90s and never fundamentally improved. It does what it was designed to do really well (bind transactions to views, zoom between list items, the transactions they compose, and the reports on those transactions) but sometimes I idly wonder what&rsquo;s been going on in bleeding edge Windows app development in the interim.</p>

<p>Last week I downloaded and played around with <a href="http://windows.github.com/">GitHub&rsquo;s excellent Windows client</a>. I vaguely remembered <a href="https://github.com/blog/1151-designing-github-for-windows">a blog post</a> on the gear underlying the desktop app awhile back, and I was interested to see where it was at these days. You know you&rsquo;re a geek when you read the entire list of licenses in the About view to get a sense of the underlying technology.</p>

<p>After looking around at the various .NET libraries involved, and reading <a href="https://github.com/blog/1127-github-for-windows">some follow-up</a> <a href="https://github.com/blog/1420-github-for-windows-recent-improvements">blog posts</a> I decided to <strong>build a front-end to a developer tool</strong> I whipped up for our developers and QA engineers at work.</p>

<p>Essentially, in debug mode QuickBooks Payroll can talk to a variety of backend environments. Configuring the various endpoints involves editing several config files that are in different places depending on whether you have an installed build or a developer build. To make it easier to configure things I wrote a command-line tool that can tell you what environments you&rsquo;re currently configured to talk to, as well as list available environments and change the current environment. I built the command-line tool on top of a library that implemented all the core logic because I knew that I&rsquo;d eventually want to build an easier-to-use GUI on top of it.</p>

<p>So as a little weekend project I took inspiration from GitHub for Windows Metro/Modern visual design and a desire to look further into ReactiveUI&rsquo;s take on multi-threaded UI.</p>

<p>Multi-threaded UI development typically has one sticking point; it&rsquo;s easy enough to define a lambda or function and set it up to run on a separate thread but one has to be very careful when moving the result of that lambda back onto the UI thread to display it. <strong>Reactive&rsquo;s</strong> secret sauce is to simplify this dangerous activity and deliver a true &lsquo;fire-and-forget&rsquo; multi-thread solution.</p>

<p>Thus far I&rsquo;ve found that it&rsquo;s very easy to chain async commands AND provide a nice responsive user experience. In cases where you have certain application behaviors that are gated upon other actions completing the ReactiveUI framework makes it extremely simple.</p>

<p>An example:</p>

<ul>
<li>App bootstraps.</li>
<li>Check for environment definition updates.</li>
<li>If updates are available; download and install updates.</li>
<li>When updates are complete, or if no updates are available then validate current saved environment settings.</li>
<li>If settings are invalid or missing show the special UI telling user to edit the app settings.</li>
<li>If settings are valid then discover the current environment.</li>
<li>Once the current environment has been determined; set the properties on the view model that are bound to the UI that describe the current environment.</li>
</ul>


<p>The state machine representing the above workflow was implemented with three View Models bound to one XAML MainWindow. The cleanest one is below, and I&rsquo;ve commented how the commands to <strong>check for updates</strong> and <strong>download and install updates</strong> are implemented (I&rsquo;m still working on tightening up the other two).</p>

<p>I&rsquo;ve included the entire file below because I think it&rsquo;s valuable to view the initialization of the commands and observers and their targets in context. This view model encapsulates all of the updater functionality and how the different states of updating are exposed to the UI.</p>

<figure class='code'><figcaption><span>EnvironmentsUpdaterViewModel.cs </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">System.ComponentModel</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">System.Reactive.Linq</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">Intuit.Payroll.Tools.SetPayrollEnvironment</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">ReactiveUI</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">ReactiveUI.Xaml</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">namespace</span> <span class="nn">Intuit.Payroll.Tools.PayrollEnvironments</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">enum</span> <span class="n">UpdateState</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">Uninitialized</span><span class="p">,</span>      <span class="c1">// No action has been taken yet</span>
</span><span class='line'>        <span class="n">CheckingForUpdates</span><span class="p">,</span> <span class="c1">// Checking the update source for possible updates</span>
</span><span class='line'>        <span class="n">UpdateAvailable</span><span class="p">,</span>    <span class="c1">// An update is available for download</span>
</span><span class='line'>        <span class="n">ApplyingUpdates</span><span class="p">,</span>    <span class="c1">// Currently downloading and installing updates</span>
</span><span class='line'>        <span class="n">Completed</span>           <span class="c1">// Used when updates have completed or when no updates are available</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">class</span> <span class="nc">EnvironmentsUpdaterViewModel</span> <span class="p">:</span> <span class="n">ReactiveObject</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">private</span> <span class="n">PayrollEnvironmentConfiguration</span> <span class="n">_EnvConfig</span><span class="p">;</span>
</span><span class='line'>        <span class="k">private</span> <span class="n">QuickBooksInformation</span> <span class="n">_LocalSettings</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">public</span> <span class="nf">EnvironmentsUpdaterViewModel</span><span class="p">(</span><span class="n">QuickBooksInformation</span> <span class="n">localInfo</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">_LocalSettings</span> <span class="p">=</span> <span class="n">localInfo</span><span class="p">;</span>
</span><span class='line'>            <span class="n">Status</span> <span class="p">=</span> <span class="n">_LocalSettings</span><span class="p">.</span><span class="n">IsValid</span> <span class="p">?</span> <span class="n">Properties</span><span class="p">.</span><span class="n">Resources</span><span class="p">.</span><span class="n">InitialUpdateMsg</span>
</span><span class='line'>                         <span class="p">:</span> <span class="n">Properties</span><span class="p">.</span><span class="n">Resources</span><span class="p">.</span><span class="n">InvalidSettingsUpdaterMsg</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>            <span class="n">UpdateState</span> <span class="p">=</span> <span class="n">UpdateState</span><span class="p">.</span><span class="n">Uninitialized</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>            <span class="n">InitializeConfiguration</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">// Creating the EnvironmentsFileUpdater implicitly goes out to the update location</span>
</span><span class='line'>            <span class="c1">// (likely on a local or VPN network share), so we want to make sure it&#39;s async.</span>
</span><span class='line'>            <span class="n">CheckForUpdates</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ReactiveAsyncCommand</span><span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'>            <span class="n">var</span> <span class="n">updaterFuture</span> <span class="p">=</span> <span class="n">CheckForUpdates</span><span class="p">.</span><span class="n">RegisterAsyncFunction</span><span class="p">(</span><span class="n">_</span> <span class="p">=&gt;</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="n">UpdateState</span> <span class="p">=</span> <span class="n">UpdateState</span><span class="p">.</span><span class="n">CheckingForUpdates</span><span class="p">;</span>
</span><span class='line'>                    <span class="k">return</span> <span class="k">new</span> <span class="nf">EnvironmentsFileUpdater</span><span class="p">(</span><span class="n">_EnvConfig</span><span class="p">);</span>
</span><span class='line'>                <span class="p">});</span>
</span><span class='line'>            <span class="n">_Updater</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ObservableAsPropertyHelper</span><span class="p">&lt;</span><span class="n">EnvironmentsFileUpdater</span><span class="p">&gt;(</span><span class="n">updaterFuture</span><span class="p">,</span> <span class="n">_</span> <span class="p">=&gt;</span> <span class="n">raisePropertyChanged</span><span class="p">(</span><span class="s">&quot;Updater&quot;</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">// When the updater has been created, initialized and set then check if any updates</span>
</span><span class='line'>            <span class="c1">// are available on the update server.</span>
</span><span class='line'>            <span class="k">this</span><span class="p">.</span><span class="n">ObservableForProperty</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Updater</span><span class="p">).</span><span class="n">Subscribe</span><span class="p">(</span><span class="n">_</span> <span class="p">=&gt;</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="k">if</span> <span class="p">(</span><span class="n">Updater</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>                    <span class="p">{</span>
</span><span class='line'>                        <span class="n">UpdateState</span> <span class="p">=</span> <span class="n">Updater</span><span class="p">.</span><span class="n">UpdateAvailable</span> <span class="p">?</span> <span class="n">UpdateState</span><span class="p">.</span><span class="n">UpdateAvailable</span> <span class="p">:</span> <span class="n">UpdateState</span><span class="p">.</span><span class="n">Completed</span><span class="p">;</span>
</span><span class='line'>                        <span class="n">Status</span> <span class="p">=</span> <span class="n">Updater</span><span class="p">.</span><span class="n">UpdateAvailable</span> <span class="p">?</span> <span class="n">Properties</span><span class="p">.</span><span class="n">Resources</span><span class="p">.</span><span class="n">EnvironmentUpdatesAvailableMsg</span>
</span><span class='line'>                                        <span class="p">:</span> <span class="kt">string</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="n">Properties</span><span class="p">.</span><span class="n">Resources</span><span class="p">.</span><span class="n">CurrentEnvironmentMessage</span><span class="p">,</span> <span class="n">Updater</span><span class="p">.</span><span class="n">LatestVersion</span><span class="p">);</span>
</span><span class='line'>                        <span class="c1">// If updates are available; download and install them</span>
</span><span class='line'>                        <span class="k">if</span> <span class="p">(</span><span class="n">UpdateState</span> <span class="p">==</span> <span class="n">UpdateState</span><span class="p">.</span><span class="n">UpdateAvailable</span><span class="p">)</span>
</span><span class='line'>                        <span class="p">{</span>
</span><span class='line'>                            <span class="n">UpdateState</span> <span class="p">=</span> <span class="n">UpdateState</span><span class="p">.</span><span class="n">ApplyingUpdates</span><span class="p">;</span>
</span><span class='line'>                            <span class="n">DownloadUpdates</span><span class="p">.</span><span class="n">Execute</span><span class="p">(</span><span class="k">null</span><span class="p">);</span>
</span><span class='line'>                        <span class="p">}</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>                <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">// After we download and apply updates, update the status and mark the workflow as completed.</span>
</span><span class='line'>            <span class="n">DownloadUpdates</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ReactiveAsyncCommand</span><span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'>            <span class="n">DownloadUpdates</span><span class="p">.</span><span class="n">RegisterAsyncAction</span><span class="p">(</span><span class="n">_</span> <span class="p">=&gt;</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="k">if</span> <span class="p">(</span><span class="n">Updater</span><span class="p">.</span><span class="n">UpdateToVersion</span><span class="p">(</span><span class="n">Updater</span><span class="p">.</span><span class="n">LatestVersion</span><span class="p">))</span>
</span><span class='line'>                    <span class="p">{</span>
</span><span class='line'>                        <span class="n">Status</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="n">Properties</span><span class="p">.</span><span class="n">Resources</span><span class="p">.</span><span class="n">CurrentEnvironmentMessage</span><span class="p">,</span> <span class="n">Updater</span><span class="p">.</span><span class="n">LatestVersion</span><span class="p">);</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>                    <span class="k">else</span>
</span><span class='line'>                    <span class="p">{</span>
</span><span class='line'>                        <span class="n">Status</span> <span class="p">=</span> <span class="n">Properties</span><span class="p">.</span><span class="n">Resources</span><span class="p">.</span><span class="n">EnvironmentUpdateErrorMsg</span><span class="p">;</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>                    <span class="n">UpdateState</span> <span class="p">=</span> <span class="n">UpdateState</span><span class="p">.</span><span class="n">Completed</span><span class="p">;</span>
</span><span class='line'>                <span class="p">});</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">private</span> <span class="k">void</span> <span class="nf">InitializeConfiguration</span><span class="p">()</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">try</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">_EnvConfig</span> <span class="p">=</span> <span class="n">EnvironmentManager</span><span class="p">.</span><span class="n">GetEnvironmentConfiguration</span><span class="p">(</span><span class="n">_LocalSettings</span><span class="p">);</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span><span class="p">)</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">_EnvConfig</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PayrollEnvironmentConfiguration</span> <span class="p">{</span> <span class="n">Version</span> <span class="p">=</span> <span class="m">0</span><span class="p">,</span>
</span><span class='line'>                                                                   <span class="n">UpdatesLocation</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span> <span class="p">};</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">private</span> <span class="n">ObservableAsPropertyHelper</span><span class="p">&lt;</span><span class="n">EnvironmentsFileUpdater</span><span class="p">&gt;</span> <span class="n">_Updater</span><span class="p">;</span>
</span><span class='line'>        <span class="k">private</span> <span class="n">EnvironmentsFileUpdater</span> <span class="n">Updater</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">_Updater</span><span class="p">.</span><span class="n">Value</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#pragma warning disable 0649</span>
</span><span class='line'>        <span class="k">private</span> <span class="n">UpdateState</span> <span class="n">_UpdateState</span><span class="p">;</span>
</span><span class='line'><span class="cp">#pragma warning restore 0649</span>
</span><span class='line'>        <span class="k">public</span> <span class="n">UpdateState</span> <span class="n">UpdateState</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">_UpdateState</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>            <span class="k">set</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="n">RaiseAndSetIfChanged</span><span class="p">(</span><span class="k">value</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#pragma warning disable 0649</span>
</span><span class='line'>        <span class="k">private</span> <span class="kt">string</span> <span class="n">_Status</span><span class="p">;</span>
</span><span class='line'><span class="cp">#pragma warning restore 0649</span>
</span><span class='line'>        <span class="k">public</span> <span class="kt">string</span> <span class="n">Status</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">_Status</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>            <span class="k">set</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="n">RaiseAndSetIfChanged</span><span class="p">(</span><span class="k">value</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">public</span> <span class="n">ReactiveAsyncCommand</span> <span class="n">CheckForUpdates</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">protected</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>        <span class="k">public</span> <span class="n">ReactiveAsyncCommand</span> <span class="n">DownloadUpdates</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">protected</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The data that the updater object fetches from is located on an intranet share, and so it was important to check for and apply updates asynchronously (especially if, like me, you&rsquo;re working over the VPN).</p>

<p>I&rsquo;m unsure at this point if it&rsquo;s ok that I&rsquo;m updating the <code>UpdateState</code> property from within many of the lambdas. I feel that there&rsquo;s something risky going on there but everything seems to work fine for me as it is.</p>

<p>I&rsquo;ll break down the two main uses of Reactive&rsquo;s async commands below. Note that I&rsquo;m using the <code>UpdateState</code> property primarily outside of this class; the window binds certain elements&#8217; visibility to the state of the updater object, but only when the state has certain values.</p>

<figure class='code'><figcaption><span>Initialize the Check for Updates Command </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="n">CheckForUpdates</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ReactiveAsyncCommand</span><span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'><span class="n">var</span> <span class="n">updaterFuture</span> <span class="p">=</span> <span class="n">CheckForUpdates</span><span class="p">.</span><span class="n">RegisterAsyncFunction</span><span class="p">(</span><span class="n">_</span> <span class="p">=&gt;</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="c1">// Set the current state</span>
</span><span class='line'>        <span class="n">UpdateState</span> <span class="p">=</span> <span class="n">UpdateState</span><span class="p">.</span><span class="n">CheckingForUpdates</span><span class="p">;</span>
</span><span class='line'>        <span class="c1">// The network access occurs in the updater constructor; this line is</span>
</span><span class='line'>        <span class="c1">// why we want this to be done asynchronously</span>
</span><span class='line'>        <span class="k">return</span> <span class="k">new</span> <span class="nf">EnvironmentsFileUpdater</span><span class="p">(</span><span class="n">_EnvConfig</span><span class="p">);</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="c1">// Connect the future object to the helper object that backs the Updater property.</span>
</span><span class='line'><span class="n">_Updater</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ObservableAsPropertyHelper</span><span class="p">&lt;</span><span class="n">EnvironmentsFileUpdater</span><span class="p">&gt;(</span><span class="n">updaterFuture</span><span class="p">,</span> <span class="n">_</span> <span class="p">=&gt;</span> <span class="n">raisePropertyChanged</span><span class="p">(</span><span class="s">&quot;Updater&quot;</span><span class="p">));</span>
</span></code></pre></td></tr></table></div></figure>


<p>When the async function returns the new <code>EnvironmentsFileUpdater</code> instance and sets the backing field of the <code>Updater</code> property, I then lean on an Observable. Below you can see that I set it up such that when the <code>Updater</code> field changes we check whether an update is available and then either kick off the <code>DownloadUpdates</code> command or set the overall state to <code>UpdateState.Completed</code> to signal to the external listeners that the update process is complete.</p>

<p>The <code>Status</code> property is the string value that&rsquo;s bound to the UI that updates the user as to what&rsquo;s happening in the update process.</p>

<figure class='code'><figcaption><span>Initialize the Updater Observer </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="c1">// When the updater has been created, initialized and set then check if any updates</span>
</span><span class='line'><span class="c1">// are available on the update server.</span>
</span><span class='line'><span class="k">this</span><span class="p">.</span><span class="n">ObservableForProperty</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Updater</span><span class="p">).</span><span class="n">Subscribe</span><span class="p">(</span><span class="n">_</span> <span class="p">=&gt;</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">Updater</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">UpdateState</span> <span class="p">=</span> <span class="n">Updater</span><span class="p">.</span><span class="n">UpdateAvailable</span> <span class="p">?</span> <span class="n">UpdateState</span><span class="p">.</span><span class="n">UpdateAvailable</span> <span class="p">:</span> <span class="n">UpdateState</span><span class="p">.</span><span class="n">Completed</span><span class="p">;</span>
</span><span class='line'>            <span class="n">Status</span> <span class="p">=</span> <span class="n">Updater</span><span class="p">.</span><span class="n">UpdateAvailable</span> <span class="p">?</span> <span class="n">Properties</span><span class="p">.</span><span class="n">Resources</span><span class="p">.</span><span class="n">EnvironmentUpdatesAvailableMsg</span>
</span><span class='line'>                            <span class="p">:</span> <span class="kt">string</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="n">Properties</span><span class="p">.</span><span class="n">Resources</span><span class="p">.</span><span class="n">CurrentEnvironmentMessage</span><span class="p">,</span> <span class="n">Updater</span><span class="p">.</span><span class="n">LatestVersion</span><span class="p">);</span>
</span><span class='line'>            <span class="c1">// If updates are available; download and install them</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span><span class="n">UpdateState</span> <span class="p">==</span> <span class="n">UpdateState</span><span class="p">.</span><span class="n">UpdateAvailable</span><span class="p">)</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">UpdateState</span> <span class="p">=</span> <span class="n">UpdateState</span><span class="p">.</span><span class="n">ApplyingUpdates</span><span class="p">;</span>
</span><span class='line'>                <span class="n">DownloadUpdates</span><span class="p">.</span><span class="n">Execute</span><span class="p">(</span><span class="k">null</span><span class="p">);</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>The <code>DownloadUpdates</code> command actually handles the work of downloading the latest environment definitions and installing them to the appropriate local storage mechanism. Again, it must reach out over the intranet and so it&rsquo;s best to make this action asynchronous.  Most of the code you see below is concerned with updating the UI-bound status value; line 5 is the key method.</p>

<figure class='code'><figcaption><span>Initialize the Download Updates Command </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="n">DownloadUpdates</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ReactiveAsyncCommand</span><span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
</span><span class='line'><span class="n">DownloadUpdates</span><span class="p">.</span><span class="n">RegisterAsyncAction</span><span class="p">(</span><span class="n">_</span> <span class="p">=&gt;</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="c1">// Update to the latest version of the environment definitions</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">Updater</span><span class="p">.</span><span class="n">UpdateToVersion</span><span class="p">(</span><span class="n">Updater</span><span class="p">.</span><span class="n">LatestVersion</span><span class="p">))</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">Status</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="n">Properties</span><span class="p">.</span><span class="n">Resources</span><span class="p">.</span><span class="n">CurrentEnvironmentMessage</span><span class="p">,</span> <span class="n">Updater</span><span class="p">.</span><span class="n">LatestVersion</span><span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="k">else</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">Status</span> <span class="p">=</span> <span class="n">Properties</span><span class="p">.</span><span class="n">Resources</span><span class="p">.</span><span class="n">EnvironmentUpdateErrorMsg</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="c1">// Finalize the state of the update process</span>
</span><span class='line'>        <span class="n">UpdateState</span> <span class="p">=</span> <span class="n">UpdateState</span><span class="p">.</span><span class="n">Completed</span><span class="p">;</span>
</span><span class='line'>    <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>I hope this has been a decent non-trivial example on how to use the ReactiveUI framework to build WPF view models; if it looks interesting have a look at the <a href="http://reactiveui.net/welcome/pdf">great docs</a> that have been synthesized from <a href="http://blog.paulbetts.org/">Paul Betts blog post examples</a> of different usages of the framework.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/12/31/twitter-and-facebook-logins-via-omniauth-in-rails/">Fitbit Logins via Omniauth in Rails</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-12-31T10:54:00-06:00" pubdate data-updated="true">Dec 31<span>st</span>, 2012</time>
        
           | <a href="/blog/2012/12/31/twitter-and-facebook-logins-via-omniauth-in-rails/#disqus_thread"
             data-disqus-identifier="http://whazzing.com/blog/2012/12/31/twitter-and-facebook-logins-via-omniauth-in-rails/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>It all started with a <a href="http://whazzing.com/blog/2012/03/20/becoming-the-finisher/#comment-743146618">comment</a> and a <a href="https://github.com/whazzmaster/fitgem-client/pull/4">pull request</a>.</p>

<p>I hadn&rsquo;t put time into maintaining my <a href="http://github.com/whazzmaster/fitgem">fitbit gem</a> <a href="http://www.fitbitclient.com">reference app</a> in quite awhile, and when I got a pull request to update it to the latest rails version I at first hesitated. After talking with some folks at <a href="http://www.bendyworks.com">my coworking space</a>, however, I decided to use some holiday downtime to pull in the changes and see if I could build on them to improve the quality of the site.</p>

<p>At first I was horrified to learn that I&rsquo;d stopped in mid-refactoring and I realized it was no wonder that Marcel (the submitter) reported he&rsquo;d had trouble getting tests to run. The first step was to delete whole directories of files and tests that no longer conformed to the current design of the site and ensure that the files that remained all contributed to that design.</p>

<p>I grabbed Marcel&rsquo;s pull request and got to work merging it in, at which point I looked at the login code and got embarrassed again. The truth is, the <a href="http://github.com/whazzmaster/fitgem">fitgem</a> library wasn&rsquo;t really built for managing oauth logins; instead it is optimized for using a token/secret for a given user to fetch data from the API. Yes, you could use fitgem to facilitate an oauth login process, but it certainly wasn&rsquo;t built with rails in mind and you had to roll your own controllers, views, and token and secret management.</p>

<p>The thing is, we already have a library that does that sort of thing: <a href="https://github.com/intridea/omniauth">OmniAuth</a> is a fantastic library for consuming <a href="https://github.com/intridea/omniauth/wiki/List-of-Strategies">pluggable login strategies</a>. I didn&rsquo;t have to search long before I found a <a href="https://github.com/tkgospodinov/omniauth-fitbit">fitbit strategy for omniauth</a>, and I set to work integrating it into the reference app.</p>

<p>Luckily I had been working a lot with OmniAuth lately, as I&rsquo;d implemented logins via Facebook and Twitter in another project just the week before. As always I leaned heavily on Ryan Bates&#8217; excellent <a href="http://railscasts.com">Railscasts</a> in getting up to speed on how <a href="http://railscasts.com/episodes/235-devise-and-omniauth-revised">OmniAuth worked with Devise</a>, and specifically with Twitter and <a href="http://railscasts.com/episodes/360-facebook-authentication">Facebook</a>. &lt;small-plug&gt;Railscasts Pro ($9/month) has been totally worth it for me. The Pro episodes go into a lot of depth and I&rsquo;ve learned a ton from them.&lt;/small-plug&gt;</p>

<p>Using the omniauth-fitbit gem I was able to delete a lot of now-redundant code for signing into/up for the application. There were, however, a few hiccups along the way that I wanted to note:</p>

<ul>
<li>Unlike Twitter and Facebook, logging into Fitbit via omniauth-fitbit doesn&rsquo;t allow devise to remember you from session to session, so you end having to re-login every time. I haven&rsquo;t yet figured out why but it may be something about how Fitbit conducts OAuth logins or it may be a configuration issue with omniauth-fitbit.</li>
<li>Logging in via Fitbit is fine and dandy, but if you want to use the token/secret for the logged-in user to fetch data from the API through the fitgem interface you&rsquo;ll need to store them. I just added fields to my user object:</li>
</ul>


<figure class='code'><figcaption><span>Add Oauth fields to User model</span><a href='https://github.com/whazzmaster/fitgem-client/blob/master/db/migrate/20121225193557_add_oauth_fields_to_users.rb'>_add_oauth_fields_to_users.rb </a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">AddOauthFieldsToUsers</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Migration</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">change</span>
</span><span class='line'>    <span class="n">add_column</span> <span class="ss">:users</span><span class="p">,</span> <span class="ss">:oauth_token</span><span class="p">,</span> <span class="ss">:string</span>
</span><span class='line'>    <span class="n">add_column</span> <span class="ss">:users</span><span class="p">,</span> <span class="ss">:oauth_secret</span><span class="p">,</span> <span class="ss">:string</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>I made some, ahem, unorthodox decisions that will have to refactored later. Chief among them was to add the FitbitClient to the User model:</li>
</ul>


<figure class='code'><figcaption><span>Access to FitbitClient through User model</span><a href='https://github.com/whazzmaster/fitgem-client/blob/master/app/models/user.rb'>user.rb </a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Elided for conciseness</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">linked?</span>
</span><span class='line'>    <span class="n">oauth_token</span><span class="o">.</span><span class="n">present?</span> <span class="o">&amp;&amp;</span> <span class="n">oauth_secret</span><span class="o">.</span><span class="n">present?</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">fitbit_data</span>
</span><span class='line'>    <span class="k">raise</span> <span class="s2">&quot;Account is not linked with a Fitbit account&quot;</span> <span class="k">unless</span> <span class="n">linked?</span>
</span><span class='line'>    <span class="vi">@client</span> <span class="o">||=</span> <span class="no">Fitgem</span><span class="o">::</span><span class="no">Client</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
</span><span class='line'>                <span class="ss">:consumer_key</span> <span class="o">=&gt;</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;FITBIT_CONSUMER_KEY&quot;</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>                <span class="ss">:consumer_secret</span> <span class="o">=&gt;</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;FITBIT_CONSUMER_SECRET&quot;</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>                <span class="ss">:token</span> <span class="o">=&gt;</span> <span class="n">oauth_token</span><span class="p">,</span>
</span><span class='line'>                <span class="ss">:secret</span> <span class="o">=&gt;</span> <span class="n">oauth_secret</span><span class="p">,</span>
</span><span class='line'>                <span class="ss">:user_id</span> <span class="o">=&gt;</span> <span class="n">uid</span>
</span><span class='line'>              <span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">has_fitbit_data?</span>
</span><span class='line'>    <span class="o">!</span><span class="vi">@client</span><span class="o">.</span><span class="n">nil?</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Elided for conciseness</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Eventually I should use a better pattern for this, but for now it&rsquo;s simplistic and anywhere you have a logged-in user in your application you will be able to call <code>fitbit_data</code> to get access to a configured FitbitClient instance.</p>

<p>And with that we&rsquo;re logging in via Fitbit and using the token/secret returned via omniuath-fitbit to fuel data retrieval from the Fitbit API through fitgem.</p>

<h3>List of Resources</h3>

<ul>
<li><a href="https://github.com/intridea/omniauth">OmniAuth</a>: Base authentication library</li>
<li><a href="https://github.com/tkgospodinov/omniauth-fitbit">omniauth-fitbit</a>: Fitbit-specific pluggable OmniAuth strategy</li>
<li><a href="http://github.com/whazzmaster/fitgem">fitgem</a>: Fitbit API library</li>
<li>Fitgem Reference Application (<a href="http://fitbitclient.com">app</a>|<a href="https://github.com/whazzmaster/fitgem-client">code</a>): An example application using omniauth-fitbit and fitgem</li>
<li><a href="http://dev.fitbit.com">Fitbit.com Developer Site</a>: Manage your developer keys for use with omniauth-fitbit and fitgem</li>
<li><a href="http://railscasts.com/episodes/235-devise-and-omniauth-revised">OmniAuth and Devise Railscast</a>: Integrating OmniAuth, Devise, and Twitter</li>
<li><a href="http://railscasts.com/episodes/360-facebook-authentication">Facebook Authentication with OmniAuth Railscast</a>: Setting up OmniAuth to work with Facebook</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/11/26/i-seem-to-be-getting-along-fine-without-facebook/">I Seem to Be Getting Along Fine Without Facebook</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-11-26T20:24:00-06:00" pubdate data-updated="true">Nov 26<span>th</span>, 2012</time>
        
           | <a href="/blog/2012/11/26/i-seem-to-be-getting-along-fine-without-facebook/#disqus_thread"
             data-disqus-identifier="http://whazzing.com/blog/2012/11/26/i-seem-to-be-getting-along-fine-without-facebook/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;m trying <strong>really</strong> hard to not read Hacker News these days, as the contrarian argument-for-argument&rsquo;s-sake nature of the comments tends to enrage me, but one of the more mystifying memes that seems to persist down in the Comments Dungeon is that the social contract of the United States of America requires you to be on Facebook.</p>

<p>In each thread where the topic appears there&rsquo;s someone that says &ldquo;I wish I didn&rsquo;t have to have a Facebook account but unfortunately it&rsquo;s required.&rdquo;  Someone responds and notes that no, <strong>it&rsquo;s not required</strong>, and all they have to do is delete their account.  That (sensible) response is then responded to a million times with the now-ubiquitous oath: to be a fully-fledged member of a social group in 2012 requires one to be on Facebook.  And to that I restate the obvious: no, it really isn&rsquo;t.</p>

<p>How many devices do you use on a daily basis? Phones, laptops, tablets, desktops, kiosks, and more.  There exists a whole world outside of Facebook and all you have to do is grasp it.  I prefer phone calls or coffee with friends over email but it&rsquo;ll do in a pinch.  I share my photos through Flickr and Twitter (depending on whether they came from my DSLR or iPhone).  I blog at a skrillion different venues.  People know where to find me online and IRL, and I&rsquo;m confident that within my social circle I won&rsquo;t be left off some invite just because I&rsquo;m not on Facebook.  My friends are my friends&mdash; we enjoy each others&#8217; company!  What I found when I deleted my Facebook account was that none of my friends really used it for anything meaningful.  My wall was eternally filled with high school people I hadn&rsquo;t seen/talked to/cared about in a decade, and extended family that I didn&rsquo;t talk to much anyways.</p>

<p>In the last 5 years I&rsquo;ve taken two significant (though very First-World-Problemy) steps: I got rid of my car, and I deleted my Facebook account.  Interestingly enough <strong>at the time I did each of these things</strong> I was much more uncomfortable and worried about having no car than that I would miss some crucial social interaction by leaving Facebook.</p>

<p>When I left Facebook there was much more a sense of relief than anything else; <strong>I suggest you try it</strong>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/08/27/madison-ruby-2012/">Madison Ruby 2012</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-08-27T17:04:00-05:00" pubdate data-updated="true">Aug 27<span>th</span>, 2012</time>
        
           | <a href="/blog/2012/08/27/madison-ruby-2012/#disqus_thread"
             data-disqus-identifier="http://whazzing.com/blog/2012/08/27/madison-ruby-2012/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><em>Please note</em>: Madison Ruby photos are now online at <a href="http://www.flickr.com/photos/whazzmaster/sets/72157631263044942/">Flickr</a>.</p>

<p><a href="http://www.flickr.com/photos/whazzmaster/7869056820/"><img class="right" src="http://farm9.staticflickr.com/8282/7869056820_aacfe79e4b_n.jpg" width="320" height="213" title="Greg Tarnoff at Madison Ruby 2012" ></a></p>

<p>I&rsquo;m working off the conference hangover. Email catchup, priotizing
tasks, etc. took up my time this morning, but I couldn&rsquo;t let Madison&rsquo;s
premier software conference fade without writing down some thoughts.</p>

<p>Firstly: much love to Jim and Jen Remsik as well as all the volunteers,
speakers, and organizers that helped make v2 of Madison Ruby even more
fun and entertaining than the inaugural conf last year. The diversity
of topics was again front and center: from team
dynamics, to talks about social justice, to funky drummers, to sources
of inspiration and the finer points of immigration law, the organizers
found a way to communicate technical content while advancing the
community in other areas as well.</p>

<p>First up was the <a href="http://madisonruby2012.sched.org/event/45828a0ad9ccd45642acbeeefabd9aa1">Design Eye for the Dev Guy or Gal</a> workshop on Thursday.  I misunderstood the focus, which is mostly because I signed up for it before a comprehensive description had been published.  <a href="https://twitter.com/pengwynn">Wynn Netherland</a> did a great job laying out the finer points of HTML5, Sass, Compass, and more.  I had expected the workshop to range more towards the philosophy of web design, rather than a technical how-to around using the tools.  Even so, however, I learned a lot about Compass.  My previous aversion stemmed from when compass and blueprint were sold as a boxed set, but I&rsquo;m definitely going to check it out on the next major project.</p>

<p>Highlight: In a discussion about the ubiquity of Twitter Bootstrap Wynn
asked how many folks were using Octopress for their dev blog, and then
added, &ldquo;You know, you don&rsquo;t HAVE to use the default style&hellip; you can add
some color in there.&rdquo; <em>sheepish grin</em></p>

<p>I may have had a little too much fun at the Github-sponsored drinkup on
Thursday evening; waking up and riding my bike downtown at 7am was a
monumental task.</p>

<p>Friday&rsquo;s talks were very interesting, especially the <a href="http://madisonruby2012.sched.org/event/b50ba5ffa1585b870253b928b153d74f"><strong>Anti-Opression 101</strong></a>
talk by Lindsey Bieda and Steve Klabnik.  Though I had seen it a
previous <a href="http://www.meetup.com/Mad-Railers/">Mad-Railers meetup</a> I also enjoyed <a href="https://twitter.com/rathboma">Matthew Rathbone</a>&rsquo;s talk
about how <a href="http://foursquare.com">Foursquare</a> uses <a href="http://hadoop.apache.org/">Hadoop</a> for its various data processing needs. Unfortunately, I had to take off early on Friday and missed some of the afternoon talks, including what I heard was a <a href="https://twitter.com/#!/search/?q=clyde+%23madisonruby&amp;src=typd">fantastic 45 minutes</a> with <a href="http://en.wikipedia.org/wiki/Clyde_Stubblefield">Clyde Stubblefield</a>.</p>

<p>Saturday I was feeling a lot better, and hit the Farmer&rsquo;s Market early
for coffee and pastries.  I&rsquo;m embarassed to say that I hadn&rsquo;t looked
at the schedule closely enough and so it was an extremely pleasant surprise
that the first talk was by Paolo Perrotta,  author of the best Ruby book
in existence: <a href="http://pragprog.com/book/ppmetr/metaprogramming-ruby">Metaprogramming Ruby</a>.
It was a great talk about ghosts, fake ghosts, and all manner of
potential problems one will encounter when using the metaprogramming
aspect of the Ruby language.</p>

<p>Later in the day were several successive talks that excited the hell out
of me, but none moreso than <a href="https://twitter.com/rubybuddha">Leon Gersing</a>&rsquo;s talk
on the Weird in programming.  Difficult to describe so I&rsquo;ll just say
that if he&rsquo;s speaking at a conference make sure you get your ass to that
talk and be prepared to enjoy it.</p>

<p>The <strong>Teaching Rails</strong> panel discussion late in the day on Saturday was
interesting.  I almost didn&rsquo;t attend because I thought it was going to
be about how best to teach Rails to new folks.  Instead it was more
about the <em>business</em> of teaching Rails and how each of the four
panelists approached it.  Ultimately the panel dovetailed into a talk
about certification, payscales, and other highly interesting topics to
any software developer.  I felt that <a href="https://twitter.com/j3">Jeff Casimir</a>&rsquo;s innocent
suggestion of some kind of certification was not considered for a single
second before being shouted down by everyone else on the panel and in
attendance.  In particular, I think his idea has merit but the operational reality is
bad, which is why everyone just said &ldquo;NO CERTIFICATION&rdquo; when I think
what is needed is a
discussion about what certification is trying to accomplish and how it
can be done without turning into a paradise for grifters and dummies.</p>

<p>This was just a taste of the goings-on at Madison Ruby 2012. Others will
likely have a fuller rundown of the events so I just hit what were, to
me, the highlights.  If you&rsquo;re down on the Ruby tip I highly suggest you
try to get to Madison for next year&rsquo;s conference.  You can already hit
the <a href="http://2013.madisonruby.org/">Very Early Bird registration page</a> and get a ticket for the low,
low price of $199.  Do it, and come hang out with me next year!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/08/19/i-have-an-idea/">I Have an Idea</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-08-19T22:14:00-05:00" pubdate data-updated="true">Aug 19<span>th</span>, 2012</time>
        
           | <a href="/blog/2012/08/19/i-have-an-idea/#disqus_thread"
             data-disqus-identifier="http://whazzing.com/blog/2012/08/19/i-have-an-idea/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Once upon a time I was in Vegas with some friends. Over the course of 72
hours myself and half a dozen friends drifted in and out of our hotel
room at different times of the day and night as we gambled and boozed
our way across the landscape.</p>

<p>At around 3am one friend drunkenly burst into the hotel room and started
going on and on about how great he was doing, gambling-wise.  He talked
at length even as it became obvious that he was winding down like some
kind of strange children&rsquo;s toy.  Then he surged out of bed and said, &ldquo;I
have an idea!&rdquo;  Another friend asked what it was and got the classic
response, &ldquo;I&rsquo;ll need $300 of your money.&rdquo;</p>

<p>&ldquo;And then what?&rdquo; asked the friend, genuinely intrigued.</p>

<p>Alas, friend one was already passed out.  When asked the next morning
what the great $300 was he had no idea what we were talking about.</p>

<p>I think about this story every time I see a vaguely defined,
ill-conceived <a href="http://www.kickstarter.com">Kickstarter campaign</a> that
will ultimately result in a fugue state where everyone wonders what
happened to their money in the morning.</p>

<p>(Note: this is not a jab at Kickstarter itself; I think there&rsquo;s some
great stuff going on there.)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/03/20/becoming-the-finisher/">Becoming the Finisher</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-03-20T09:13:00-05:00" pubdate data-updated="true">Mar 20<span>th</span>, 2012</time>
        
           | <a href="/blog/2012/03/20/becoming-the-finisher/#disqus_thread"
             data-disqus-identifier="http://whazzing.com/blog/2012/03/20/becoming-the-finisher/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Via <a href="http://news.ycombinator.com/item?id=3728664">Hacker News</a> this morning I read Jacques Mattheij&rsquo;s <a href="http://jacquesmattheij.com/The+Starter+the+Architect+the+Debugger+and+the+Finisher">The Starter, the Architect, the Debugger and the Finisher</a>.  It was a great topic and one that I think about often; for me personally <strong>finishing projects smoothly is my biggest challenge</strong>.</p>

<p>For me, starting projects is a great time to be alive.  I love bootstrapping repeatable builds, testing systems, automatic doc generation, etc.  It&rsquo;s a reflexive response having seen so many projects that were doomed from the word &lsquo;go&rsquo; by developers who named folders any old thing.  Even folks that joined the team within the first year were confused as to where code was located and what (if any) naming conventions existed.</p>

<p>Similarly, I&rsquo;ve been writing software for millions of users for ten years now and these days I think intensely about architecture when bootstrapping new components or applications.  Making the appropriate trade-offs between short- and long-term design up front will accelerate development while leaving you open to pivoting or scaling when the time is right.</p>

<p>My problem comes to the final touches of a release.  For example, often when I&rsquo;m working on a new release of <a href="https://github.com/whazzmaster/fitgem">fitgem</a> I code up the functionality, write new tests, write inline API documentation as I create new methods, etc.  After I think I&rsquo;m done I&rsquo;ll take the library for a spin in <a href="http://pry.github.com">Pry</a> and start coding against the new API functions.  Things will go well for awhile and then I&rsquo;ll hit a snag where I forgot a parameter or had a typo in the code.  Great! My ad-hoc testing revealed something I hadn&rsquo;t included in the unit tests. <strong>AND THEN I RELEASE</strong>.  This is not a good thing, but I often spaz out when I get 95% of the way to finishing, hit a snag, and then fix my issue.  I guess I feel exasperated about how long this thing is taking and then just wig out and push it (WE&rsquo;LL DO IT LIVE!)</p>

<p>To be a good finisher I need to slow down and restart my release process (as light as it is!) when I hit problems.  I need to suppress the anxiousness when I hit minor problems before pushing live, go back to the top of my checklist, and start it over.  Doing that on small projects like a gem will instill good mental resistance to spazzing for large, important releases.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/03/18/dont-call-me-an-engineer/">Don&#8217;t Call Me an Engineer</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-03-18T11:13:00-05:00" pubdate data-updated="true">Mar 18<span>th</span>, 2012</time>
        
           | <a href="/blog/2012/03/18/dont-call-me-an-engineer/#disqus_thread"
             data-disqus-identifier="http://whazzing.com/blog/2012/03/18/dont-call-me-an-engineer/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>When I go <a href="http://www.wisc.edu">on campus</a> to do university recruiting, or I&rsquo;m in a non-technical social situation where I must explain what I do for a living, I often take great pains to explain what should be a simple thing.  My title in my company is &ldquo;Senior Software Engineer&rdquo; but I always very precisely call myself a &ldquo;software developer,&rdquo; &ldquo;programmer,&rdquo; or &ldquo;software nerd.&rdquo;</p>

<p>I am uncomfortable specifically with the &ldquo;engineer&rdquo; label, and that discomfort stems primarily from a panel discussion I attended in conjunction with the <a href="https://ecs.engr.wisc.edu/public/index.php">UW Engineering Career Services</a> group.</p>

<p>For some background, at the University of Wisconsin-Madison, Computer Science is <em>not</em> part of the School of Engineering, but a department in the School of Letters &amp; Science.  Even so, Computer Science students are given leave to particpate in School of Engineering career fairs and recruiting due to the crossover technical skillset.</p>

<p>As someone who conducts on-campus interviews and attends career fairs for my company at UW I was invited to a panel discussion on &ldquo;starting your first engineering job after graduating.&rdquo;  It was a fantastic topic for a panel because many seniors are so busy interviewing, wrapping up courses, and thinking about relocation concerns that they often don&rsquo;t think much about the actual beginning of a professional career.  Other folks on the panel included chemical engineers, industrial engineers, civil engineers, mechanical engineers and more.</p>

<p>Topics ranged across the board (Do you work a lot of hours? Do you like your boss? Have you been promoted yet?) but one that stuck with me was the question: &ldquo;Should I pay/study for my engineer certification? Is it better to do it before interviewing or will my employer fund the cost?&rdquo;  Many engineers on the panel had various opinions and it really did vary widely by field, but when it got to me I just shrugged and told the truth: <strong>there is no professional certification to be a software &ldquo;engineer&rdquo;</strong>.  There are certainly certifications for working with a particular software system, but there is no certification that will allow you to be insured against writing buggy software.<sup id='fnref:1'><a href='#fn:1' rel='footnote'>1</a></sup></p>

<p>I admire engineers and really only want to drive on bridges and use power tools that were designed by professional engineers.  Software developers
CAN produce incredible feats of redundant, bug-free software system design and implementation but with the stipulation that time and process are needed to accomplish such things.  There likely do exist folks with the sufficient experience and knowledge to be called software engineers, but I am not one of them and they are few and far between.</p>

<p>In the tech sphere this is really more of an academic conversation- we all speak the same language.  Everyone at your software company has some flavor of &ldquo;engineer&rdquo; in their title, and no one thinks twice about it.  When thrust into the larger world of engineers, however, the loosey-goosey nature of software development and it&rsquo;s similarity to more of a craft than a discipline make strict adherance to standards of proven technical excellence difficult.</p>

<p>What do you think? Does the typical professional software development environment make you think of &ldquo;engineering&rdquo; in the same way that mechanical or civil engineers practice it?  Does the fact that we do TDD/BDD make up for the fact that software tends not to have perfectly understood natural laws it must follow?</p>

<div class="footnotes">
    <ol>
        <li id='fn:1'>This argument has indeed been made <a href="http://www.google.com/search?q=software+development+is+not+engineering">many times before</a>; this post is more my feelings about it. <a href='#fnref:1' rev='footnote'></a></li>
    </ol>
</div>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/03/17/whazzing-dot-com-moved-to-github/">Whazzing.com Moved to Github</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-03-17T23:09:00-05:00" pubdate data-updated="true">Mar 17<span>th</span>, 2012</time>
        
           | <a href="/blog/2012/03/17/whazzing-dot-com-moved-to-github/#disqus_thread"
             data-disqus-identifier="http://whazzing.com/blog/2012/03/17/whazzing-dot-com-moved-to-github/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Two things forced my hand to move my development blog off of my own Rails-based blogging codebase and onto
<a href="http://pages.github.com/">Github Pages</a> via <a href="http://octopress.org/">Octopress</a>:</p>

<ol>
<li>My VPS is becoming severely overcrowded with deployed apps; I use it as a testbed for a lot of ideas as well as my <a href="http://www.whazzmaster.com">main swearing-at-pop-culture blog</a> and I didn&rsquo;t want to host yet another heavyweight rails app to chew through limited resources.</li>
<li>I reaaally like the &lsquo;one-file-per-post&rsquo; model of Octopress/Jekyll, and keeping my development blog/presentations right next to my open source code is very appealing.</li>
</ol>


<p>Since I wrote my latest blog engine to take markdown input it was easy-as-pie to export the existing posts to files and then use them to bootstrap this Octopress site.  For now I&rsquo;ll ride on the default theme and see how it goes.  I hope to spend more time iterating on my presentations and a bunch of C++ code that I&rsquo;m working on for a work project, so it&rsquo;s also a plus that I don&rsquo;t have maintain the platform source tree anymore.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
	<h1>About Me</h1>
	<p>
		I&#8217;m <b>Zachery Moneypenny</b>: a developer for <a href="http://payroll.intuit.com/">Intuit QuickBooks Payroll</a>,
		Rubyist, Coffeescripter, Sasser, etc.  And hey, what&#8217;s this?  Renewed C++ Vigor.
	</p>
	<p>
		<a href="/about/">More&#8230;</a>
	</p>	
</section><section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/12/01/catching-up/">Catching Up</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/11/automated-clickonce-build-and-deploy-using-powershell-and-msbuild/">Automated ClickOnce Build and Deploy Using Powershell and MSBuild</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/22/responsive-wpf-applications-with-reactiveui/">Responsive WPF Applications With ReactiveUI</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/12/31/twitter-and-facebook-logins-via-omniauth-in-rails/">Fitbit Logins via Omniauth in Rails</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/11/26/i-seem-to-be-getting-along-fine-without-facebook/">I Seem to Be Getting Along Fine Without Facebook</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/whazzmaster">@whazzmaster</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'whazzmaster',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("whazzmaster", 5, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/whazzmaster" class="twitter-follow-button" data-show-count="true">Follow @whazzmaster</a>
  
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Zachery Moneypenny -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'whazzingcom';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
